# マジックメソッド（Magic Methods）とは

## 1. 簡単な説明
- **マジックメソッド**は、特別な名前を持つ関数のようなものです。
- 特定のタイミングになると、自動で動きます。
- 名前の前後に **`__`（アンダーバー2つ）** が付いています。
- 普通の関数と違って、自分で呼び出さなくてもPHPが勝手に実行します。

---

## 2. イメージ
> 冷蔵庫のドアを開けると自動でライトが点く。  
> ボタンを押さなくても「ドアを開ける」という行動でライトが点くように、  
> マジックメソッドも、ある行動がきっかけで自動で動きます。

---

## 3. 主なマジックメソッド一覧（初心者向け）

| 名前 | いつ動くか | 例 |
|------|-----------|----|
| `__construct()` | 新しく作られたとき | 初期設定をする |
| `__destruct()` | 使い終わったとき | 後片付けをする |
| `__get($name)` | 無いプロパティを読んだとき | データを動的に返す |
| `__set($name, $value)` | 無いプロパティに値を入れたとき | データを動的に保存する |
| `__isset($name)` | `isset()` や `empty()` をしたとき | 値があるかどうかを返す |
| `__unset($name)` | `unset()` で削除するとき | データを削除する |
| `__call($name, $args)` | 無い関数を呼んだとき | 呼び出しに合わせた処理をする |
| `__callStatic($name, $args)` | 無い静的関数を呼んだとき | 静的な呼び出しに合わせた処理をする |
| `__toString()` | オブジェクトを文字として使うとき | 表示用の文字を作る |
| `__invoke()` | オブジェクトを関数のように呼んだとき | 関数のような動きをする |
| `__clone()` | `clone` で複製するとき | 複製時の特別な処理をする |
| `__sleep()` | `serialize()` で保存するとき | 保存する内容を決める |
| `__wakeup()` | `unserialize()` で復元するとき | 復元時の特別な処理をする |
| `__debugInfo()` | `var_dump()` で表示するとき | 表示内容をカスタマイズする |

---

## 4. 簡単なコード例
```php
class User {
    private $data = [];

    public function __set($name, $value) {
        echo "{$name} に {$value} を設定しました\n";
        $this->data[$name] = $value;
    }

    public function __get($name) {
        echo "{$name} を読み込みました\n";
        return $this->data[$name] ?? null;
    }

    public function __toString() {
        return "ユーザー情報: " . json_encode($this->data, JSON_UNESCAPED_UNICODE);
    }
}

$user = new User();
$user->name = "Alice";   // __set が自動で動く
echo $user->name;        // __get が自動で動く
echo "\n" . $user;      // __toString が自動で動く
```

---

## 5. どんなときに使う？
1. **データの読み書きを自動化したいとき**
2. **見た目や表示方法を自由に変えたいとき**
3. **存在しないデータや関数を柔軟に扱いたいとき**
4. **アクセスの記録（ログ）を取りたいとき**

---

## 6. メリット
- 自動で動くので、コードがスッキリする
- 特別なタイミングで特別な処理を入れられる
- 後から機能を追加しやすい

---

## 7. 注意点
- 使いすぎると「いつ動くのか分かりにくい」コードになる
- 初めて読む人には動きが見えづらい
- 必要なときだけ使うのがおすすめ

---

## 8. チェックリスト（使う前に考えること）
- [ ] 自動で動く必要があるか？
- [ ] その処理は普通の関数でも書けるか？
- [ ] 読む人にとって分かりやすいか？
- [ ] あとから変更・修正しやすいか？
